# Another Life æ¸¸æˆäº‹ä»¶åˆ›ä½œæŒ‡å—

## ğŸ“– æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†å¦‚ä½•ä¸º Another Life æ¸¸æˆåˆ›ä½œäº‹ä»¶ã€‚äº‹ä»¶æ˜¯æ¸¸æˆçš„æ ¸å¿ƒå†…å®¹ï¼Œå†³å®šäº†ç©å®¶çš„æ¸¸æˆä½“éªŒå’Œè§’è‰²å‘å±•ã€‚

## ğŸ¯ äº‹ä»¶åŸºç¡€ç»“æ„

### æ ¸å¿ƒæ¥å£å®šä¹‰

#### GameEvent æ¥å£ï¼ˆä¸»æ¥å£ï¼‰

```typescript
interface GameEvent {
  // åŸºç¡€ä¿¡æ¯
  id: string;                    // äº‹ä»¶å”¯ä¸€æ ‡è¯†ç¬¦
  type: EventType;               // äº‹ä»¶ç±»å‹
  name: string;                  // äº‹ä»¶åç§°
  description: string;           // äº‹ä»¶æè¿°
  
  // å›¾ç‰‡ç›¸å…³ï¼ˆå¯é€‰ï¼‰
  imageUrl?: string;             // äº‹ä»¶å›¾ç‰‡åœ°å€
  imageAlt?: string;             // å›¾ç‰‡æ›¿ä»£æ–‡æœ¬
  
  // è§¦å‘æ¡ä»¶ï¼ˆå¯é€‰ï¼‰
  conditions?: EventCondition[]; // è§¦å‘æ¡ä»¶æ•°ç»„
  conditionLogic?: 'AND' | 'OR'; // æ¡ä»¶é€»è¾‘ï¼Œé»˜è®¤AND
  
  // äº‹ä»¶ç»“æœ
  outcomes: EventOutcome[];      // äº‹ä»¶ç»“æœæ•°ç»„
  
  // æ¦‚ç‡å’Œæƒé‡
  probability?: number;          // è§¦å‘æ¦‚ç‡ (0-1)
  weight?: number;              // äº‹ä»¶æƒé‡
  
  // äº‹ä»¶é“¾ç›¸å…³ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰
  chainId?: string;             // äº‹ä»¶é“¾ID
  isChainStart?: boolean;       // æ˜¯å¦ä¸ºé“¾èµ·å§‹
  isChainEnd?: boolean;         // æ˜¯å¦ä¸ºé“¾ç»“æŸ
  nextEvents?: ChainNextEvent[]; // ä¸‹ä¸€æ­¥äº‹ä»¶
  chainContextKey?: string;     // é“¾ä¸Šä¸‹æ–‡å­˜å‚¨çš„key
  skipNormalEvents?: boolean;   // æ˜¯å¦è·³è¿‡å…¶ä»–äº‹ä»¶
}
```

#### EventType ç±»å‹å®šä¹‰

```typescript
type EventType = 'battle' | 'findItem' | 'levelUp' | 'custom';
```

#### EventCondition æ¥å£ï¼ˆè§¦å‘æ¡ä»¶ï¼‰

```typescript
interface EventCondition {
  type: 'attribute' | 'item' | 'level' | 'itemCount' | 'custom' 
      | 'history' | 'streak' | 'cumulative' | 'daysSince' | 'eventCount' | 'chainContext';
  key: string;                   // æ¡ä»¶é”®å
  operator: '>' | '>=' | '<' | '<=' | '==' | '!='; // æ¯”è¾ƒæ“ä½œç¬¦
  value: number | string;        // æ¯”è¾ƒå€¼
  
  // å†å²æ¡ä»¶ä¸“ç”¨å‚æ•°
  historyType?: 'eventTriggered' | 'attributeChange' | 'itemGained' | 'itemLost' | 'dayPassed';
  timeWindow?: number;           // æ£€æŸ¥çš„æ—¶é—´çª—å£ï¼ˆå¤©æ•°ï¼‰
  consecutive?: boolean;         // æ˜¯å¦éœ€è¦è¿ç»­
  
  // äº‹ä»¶é“¾ä¸Šä¸‹æ–‡æ¡ä»¶ä¸“ç”¨å‚æ•°
  contextPath?: string;          // ä¸Šä¸‹æ–‡ä¸­çš„è·¯å¾„ï¼Œå¦‚ 'choice.selectedOption'
}
```

#### EventOutcome æ¥å£ï¼ˆäº‹ä»¶ç»“æœï¼‰

```typescript
interface EventOutcome {
  type: 'attributeChange' | 'levelChange' | 'itemGain' | 'itemLoss' | 'custom' | 'chainContext' | 'randomOutcome';
  key: string;                   // ç»“æœé”®å
  value?: number | string;       // å›ºå®šå€¼ï¼ˆä¸randomäº’æ–¥ï¼‰
  
  // éšæœºç»“æœæ”¯æŒ
  random?: RandomValueConfig;    // éšæœºå€¼é…ç½®ï¼ˆä¸valueäº’æ–¥ï¼‰
  
  // é“¾ä¸Šä¸‹æ–‡æ“ä½œä¸“ç”¨å‚æ•°
  contextOperation?: 'set' | 'add' | 'remove' | 'append'; // ä¸Šä¸‹æ–‡æ“ä½œç±»å‹
  contextPath?: string;          // ä¸Šä¸‹æ–‡è·¯å¾„ï¼Œå¦‚ 'choices.lastDecision'
  
  // éšæœºç»“æœä¸“ç”¨å‚æ•° (type: 'randomOutcome')
  possibleOutcomes?: Array<{
    outcome: Omit<EventOutcome, 'possibleOutcomes'>; // é€’å½’æ’é™¤é¿å…æ— é™åµŒå¥—
    probability?: number;        // è§¦å‘æ¦‚ç‡ï¼Œé»˜è®¤1.0
    weight?: number;            // æƒé‡ï¼Œç”¨äºåŠ æƒéšæœºé€‰æ‹©
  }>;
}
```

#### RandomValueConfig æ¥å£ï¼ˆéšæœºå€¼é…ç½®ï¼‰

```typescript
interface RandomValueConfig {
  type: 'range' | 'choice' | 'weighted';
  
  // èŒƒå›´éšæœº (type: 'range')
  min?: number;                  // æœ€å°å€¼
  max?: number;                  // æœ€å¤§å€¼
  
  // é€‰æ‹©éšæœº (type: 'choice')
  choices?: Array<number | string>; // å¯é€‰æ‹©çš„å€¼åˆ—è¡¨
  
  // æƒé‡éšæœº (type: 'weighted')
  weightedChoices?: Array<{
    value: number | string;      // å€¼
    weight: number;             // æƒé‡
  }>;
  
  // é€šç”¨é…ç½®
  allowFloat?: boolean;          // æ˜¯å¦å…è®¸æµ®ç‚¹æ•°ï¼Œé»˜è®¤false
}
```

#### ChainNextEvent æ¥å£ï¼ˆäº‹ä»¶é“¾ä¸‹ä¸€æ­¥é…ç½®ï¼‰

```typescript
interface ChainNextEvent {
  eventId: string;               // ä¸‹ä¸€ä¸ªäº‹ä»¶çš„ID
  probability?: number;          // è§¦å‘æ¦‚ç‡ï¼Œé»˜è®¤1.0
  delay?: number;               // å»¶è¿Ÿå¤©æ•°ï¼Œ0è¡¨ç¤ºç«‹å³è§¦å‘
  contextUpdate?: { [key: string]: any }; // ä¼ é€’ç»™ä¸‹ä¸€ä¸ªäº‹ä»¶çš„ä¸Šä¸‹æ–‡æ›´æ–°
}
```

## ğŸ“‹ å¿…å¡«å­—æ®µè¯¦è§£

### 1. id (å¿…å¡«)
- **ç±»å‹**: `string`
- **è¯´æ˜**: äº‹ä»¶çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¸èƒ½é‡å¤
- **å‘½åè§„åˆ™**: ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”çš„å°å†™å­—æ¯ï¼Œæè¿°æ€§å¼º
- **ç¤ºä¾‹**: 
  ```typescript
  id: 'forest_exploration'      // âœ… å¥½çš„å‘½å
  id: 'battle_goblin_cave'      // âœ… å¥½çš„å‘½å
  id: 'event1'                  // âŒ ä¸å¤Ÿæè¿°æ€§
  ```

### 2. type (å¿…å¡«)
- **ç±»å‹**: `'battle' | 'findItem' | 'levelUp' | 'custom'`
- **è¯´æ˜**: äº‹ä»¶çš„åˆ†ç±»ç±»å‹
- **é€‰é¡¹**:
  - `'battle'`: æˆ˜æ–—ç±»äº‹ä»¶
  - `'findItem'`: ç‰©å“å‘ç°ç±»äº‹ä»¶
  - `'levelUp'`: å‡çº§ç±»äº‹ä»¶
  - `'custom'`: è‡ªå®šä¹‰ç±»äº‹ä»¶

### 3. name (å¿…å¡«)
- **ç±»å‹**: `string`
- **è¯´æ˜**: äº‹ä»¶çš„æ˜¾ç¤ºåç§°ï¼Œç©å®¶å¯è§
- **å»ºè®®**: ç®€æ´æœ‰åŠ›ï¼Œèƒ½æ¦‚æ‹¬äº‹ä»¶å†…å®¹
- **ç¤ºä¾‹**:
  ```typescript
  name: 'æ£®æ—æ¢ç´¢'
  name: 'ç¥ç§˜å•†äºº'
  name: 'å¤è€é—è¿¹'
  ```

### 4. description (å¿…å¡«)
- **ç±»å‹**: `string`
- **è¯´æ˜**: äº‹ä»¶çš„è¯¦ç»†æè¿°ï¼Œä¸ºç©å®¶æä¾›æƒ…å¢ƒ
- **å»ºè®®**: ç”ŸåŠ¨æœ‰è¶£ï¼Œè¥é€ æ°›å›´
- **ç¤ºä¾‹**:
  ```typescript
  description: 'ä½ åœ¨èŒ‚å¯†çš„æ£®æ—ä¸­å‘ç°äº†ä¸€æ¡éšç§˜çš„å°å¾„ï¼Œä¸çŸ¥é€šå‘ä½•æ–¹...'
  ```

### 5. outcomes (å¿…å¡«)
- **ç±»å‹**: `EventOutcome[]`
- **è¯´æ˜**: äº‹ä»¶è§¦å‘åçš„ç»“æœæ•°ç»„
- **è¯¦è§**: [äº‹ä»¶ç»“æœç« èŠ‚](#äº‹ä»¶ç»“æœ-eventoutcome)

## ğŸ–¼ï¸ å›¾ç‰‡ç›¸å…³å­—æ®µ

### imageUrl (å¯é€‰)
- **ç±»å‹**: `string`
- **è¯´æ˜**: äº‹ä»¶å›¾ç‰‡çš„URLåœ°å€
- **æ”¯æŒæ ¼å¼**:
  - ç½‘ç»œå›¾ç‰‡: `'https://example.com/image.jpg'`
  - æœ¬åœ°å›¾ç‰‡: `'/src/assets/event-image.png'`
- **å»ºè®®å°ºå¯¸**: 400x300px æˆ– 16:9 æ¯”ä¾‹
- **ç¤ºä¾‹**:
  ```typescript
  imageUrl: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=400&h=300&fit=crop'
  ```

### imageAlt (å¯é€‰)
- **ç±»å‹**: `string`
- **è¯´æ˜**: å›¾ç‰‡çš„æ›¿ä»£æ–‡æœ¬ï¼Œç”¨äºæ— éšœç¢è®¿é—®
- **é»˜è®¤å€¼**: å¦‚æœä¸æä¾›ï¼Œå°†ä½¿ç”¨äº‹ä»¶åç§°
- **ç¤ºä¾‹**:
  ```typescript
  imageAlt: 'èŒ‚å¯†çš„æ£®æ—å°å¾„'
  ```

## ğŸ² è§¦å‘æ¡ä»¶ (EventCondition)

### æ¡ä»¶ç±»å‹

#### 1. å±æ€§æ¡ä»¶ (attribute)
æ£€æŸ¥è§’è‰²çš„åŸºç¡€å±æ€§ï¼ˆåŠ›é‡ã€æ•æ·ã€æ™ºåŠ›ã€ä½“åŠ›ï¼‰

```typescript
{
  type: 'attribute',
  key: 'strength',           // å±æ€§å: strength, agility, intelligence, stamina
  operator: '>=',            // æ¯”è¾ƒæ“ä½œç¬¦
  value: 5                   // æ¯”è¾ƒå€¼
}
```

#### 2. ç‰©å“æ¡ä»¶ (item)
æ£€æŸ¥æ˜¯å¦æ‹¥æœ‰ç‰¹å®šç‰©å“

```typescript
{
  type: 'item',
  key: 'sword_001',          // ç‰©å“ID
  operator: '==',            // == è¡¨ç¤ºæ‹¥æœ‰ï¼Œ!= è¡¨ç¤ºä¸æ‹¥æœ‰
  value: 1                   // é€šå¸¸ä¸º1
}
```

#### 3. ç­‰çº§æ¡ä»¶ (level)
æ£€æŸ¥è§’è‰²ç­‰çº§

```typescript
{
  type: 'level',
  key: 'level',              // å›ºå®šä¸º 'level'
  operator: '>=',
  value: 3
}
```

#### 4. ç‰©å“æ•°é‡æ¡ä»¶ (itemCount)
æ£€æŸ¥ç‰¹å®šç‰©å“çš„æ•°é‡

```typescript
{
  type: 'itemCount',
  key: 'gold',               // ç‰©å“ID
  operator: '>=',
  value: 100                 // éœ€è¦çš„æ•°é‡
}
```

#### 5. å†å²æ¡ä»¶ (history)
åŸºäºè§’è‰²çš„å†å²è®°å½•è¿›è¡Œåˆ¤æ–­

```typescript
{
  type: 'history',
  key: 'battle_won',         // å†å²äº‹ä»¶ç±»å‹
  operator: '>=',
  value: 3,                  // æ¬¡æ•°
  timeWindow: 7              // æ—¶é—´çª—å£ï¼ˆå¤©æ•°ï¼‰
}
```

### æ¯”è¾ƒæ“ä½œç¬¦
- `'>'`: å¤§äº
- `'>='`: å¤§äºç­‰äº
- `'<'`: å°äº
- `'<='`: å°äºç­‰äº
- `'=='`: ç­‰äº
- `'!='`: ä¸ç­‰äº

### æ¡ä»¶é€»è¾‘ (conditionLogic)
- **ç±»å‹**: `'AND' | 'OR'`
- **é»˜è®¤**: `'AND'`
- **è¯´æ˜**:
  - `'AND'`: æ‰€æœ‰æ¡ä»¶éƒ½å¿…é¡»æ»¡è¶³
  - `'OR'`: ä»»æ„ä¸€ä¸ªæ¡ä»¶æ»¡è¶³å³å¯

## ğŸ äº‹ä»¶ç»“æœ (EventOutcome)

### åŸºç¡€ç»“æœç±»å‹

#### 1. å±æ€§å˜åŒ– (attributeChange)
```typescript
{
  type: 'attributeChange',
  key: 'strength',           // å±æ€§å
  value: 2                   // å˜åŒ–å€¼ï¼ˆæ­£æ•°å¢åŠ ï¼Œè´Ÿæ•°å‡å°‘ï¼‰
}
```

#### 2. ç­‰çº§å˜åŒ– (levelChange)
```typescript
{
  type: 'levelChange',
  key: 'level',              // å›ºå®šä¸º 'level'
  value: 1                   // ç­‰çº§å˜åŒ–
}
```

#### 3. ç‰©å“è·å¾— (itemGain)
```typescript
{
  type: 'itemGain',
  key: 'sword_001',          // ç‰©å“ID
  value: 1                   // è·å¾—æ•°é‡
}
```

#### 4. ç‰©å“å¤±å» (itemLoss)
```typescript
{
  type: 'itemLoss',
  key: 'gold',               // ç‰©å“ID
  value: 50                  // å¤±å»æ•°é‡
}
```

#### 5. è‡ªå®šä¹‰ç»“æœ (custom)
```typescript
{
  type: 'custom',
  key: 'fullHeal',           // è‡ªå®šä¹‰æ“ä½œæ ‡è¯†
  value: 0                   // å¯é€‰çš„å‚æ•°å€¼
}
```

### ğŸ² éšæœºç»“æœåŠŸèƒ½

#### éšæœºèŒƒå›´å€¼
```typescript
{
  type: 'attributeChange',
  key: 'strength',
  random: {
    type: 'range',
    min: 1,                  // æœ€å°å€¼
    max: 5,                  // æœ€å¤§å€¼
    allowFloat: false        // æ˜¯å¦å…è®¸å°æ•°
  }
}
```

#### éšæœºé€‰æ‹©
```typescript
{
  type: 'attributeChange',
  key: 'agility',
  random: {
    type: 'choice',
    choices: [1, 3, 5, 10]   // ä»è¿™äº›å€¼ä¸­éšæœºé€‰æ‹©
  }
}
```

#### æƒé‡éšæœº
```typescript
{
  type: 'itemGain',
  key: 'treasure',
  random: {
    type: 'weighted',
    weightedChoices: [
      { value: 1, weight: 50 },  // 50% æ¦‚ç‡è·å¾—1ä¸ª
      { value: 3, weight: 30 },  // 30% æ¦‚ç‡è·å¾—3ä¸ª
      { value: 5, weight: 20 }   // 20% æ¦‚ç‡è·å¾—5ä¸ª
    ]
  }
}
```

#### å¤šé€‰ä¸€éšæœºç»“æœ
```typescript
{
  type: 'randomOutcome',
  key: 'multipleChoice',
  possibleOutcomes: [
    {
      outcome: { type: 'attributeChange', key: 'strength', value: 2 },
      weight: 3,               // æƒé‡
      probability: 0.8         // æ¦‚ç‡
    },
    {
      outcome: { type: 'itemGain', key: 'sword', value: 1 },
      weight: 1,
      probability: 0.6
    }
  ]
}
```

## ğŸ“Š æ¦‚ç‡å’Œæƒé‡

### probability (å¯é€‰)
- **ç±»å‹**: `number` (0-1)
- **è¯´æ˜**: äº‹ä»¶çš„è§¦å‘æ¦‚ç‡
- **é»˜è®¤**: `1.0` (100%)
- **ç¤ºä¾‹**:
  ```typescript
  probability: 0.3           // 30% æ¦‚ç‡è§¦å‘
  ```

### weight (å¯é€‰)
- **ç±»å‹**: `number`
- **è¯´æ˜**: äº‹ä»¶çš„æƒé‡ï¼Œå½±å“é€‰æ‹©ä¼˜å…ˆçº§
- **é»˜è®¤**: `1`
- **è¯´æ˜**: æƒé‡è¶Šé«˜ï¼Œè¢«é€‰ä¸­çš„æ¦‚ç‡è¶Šå¤§
- **ç¤ºä¾‹**:
  ```typescript
  weight: 5                  // è¾ƒé«˜æƒé‡
  ```

## ğŸ”— äº‹ä»¶é“¾ç³»ç»Ÿ (é«˜çº§åŠŸèƒ½)

äº‹ä»¶é“¾å…è®¸åˆ›å»ºè¿ç»­æ€§çš„å¤šæ­¥éª¤äº‹ä»¶åºåˆ—ã€‚

### åŸºç¡€äº‹ä»¶é“¾
```typescript
// é“¾çš„èµ·å§‹äº‹ä»¶
{
  id: 'quest_start',
  name: 'ç¥ç§˜ä»»åŠ¡å¼€å§‹',
  isChainStart: true,
  chainId: 'mystery_quest',
  nextEvents: [
    {
      eventId: 'quest_middle',
      delay: 1,                // 1å¤©åè§¦å‘
      conditions: []
    }
  ]
}

// é“¾çš„ä¸­é—´äº‹ä»¶
{
  id: 'quest_middle',
  name: 'ä»»åŠ¡è¿›è¡Œä¸­',
  chainId: 'mystery_quest',
  nextEvents: [
    {
      eventId: 'quest_end',
      delay: 0,                // ç«‹å³è§¦å‘
      conditions: []
    }
  ]
}

// é“¾çš„ç»“æŸäº‹ä»¶
{
  id: 'quest_end',
  name: 'ä»»åŠ¡å®Œæˆ',
  chainId: 'mystery_quest',
  isChainEnd: true
}
```

## ğŸ› ï¸ ä¾¿æ·å·¥å‚æ–¹æ³•

ä½¿ç”¨ `OutcomeFactory` ç±»å¯ä»¥æ›´æ–¹ä¾¿åœ°åˆ›å»ºç»“æœï¼š

```typescript
import { OutcomeFactory } from '../outcomeFactory';

// åŸºç¡€æ–¹æ³•
OutcomeFactory.attributeChange('strength', 2)
OutcomeFactory.itemGain('sword', 1)
OutcomeFactory.levelChange(1)

// éšæœºæ–¹æ³•
OutcomeFactory.randomAttributeChange('strength', 1, 5)
OutcomeFactory.randomItemGain('gold', 10, 50)
OutcomeFactory.choiceAttributeChange('agility', [1, 3, 5])
OutcomeFactory.weightedAttributeChange('intelligence', [
  { value: 1, weight: 50 },
  { value: 3, weight: 30 },
  { value: 5, weight: 20 }
])
OutcomeFactory.multipleChoice([
  {
    outcome: OutcomeFactory.attributeChange('strength', 2),
    weight: 3
  },
  {
    outcome: OutcomeFactory.itemGain('sword', 1),
    weight: 1
  }
])
```

## ğŸ“ å®Œæ•´äº‹ä»¶ç¤ºä¾‹

### ç®€å•äº‹ä»¶
```typescript
{
  id: 'forest_walk',
  type: 'custom',
  name: 'æ£®æ—æ¼«æ­¥',
  description: 'ä½ åœ¨æ£®æ—ä¸­æ‚ é—²åœ°æ•£æ­¥ï¼Œå‘¼å¸ç€æ–°é²œç©ºæ°”',
  imageUrl: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=400&h=300&fit=crop',
  imageAlt: 'æ£®æ—å°å¾„',
  conditions: [
    { type: 'attribute', key: 'stamina', operator: '>=', value: 2 }
  ],
  outcomes: [
    OutcomeFactory.attributeChange('stamina', -1),
    OutcomeFactory.attributeChange('intelligence', 1)
  ],
  probability: 0.6,
  weight: 3
}
```

### å¤æ‚éšæœºäº‹ä»¶
```typescript
{
  id: 'treasure_hunt',
  type: 'findItem',
  name: 'å¯»å®æ¢é™©',
  description: 'ä½ å‘ç°äº†ä¸€ä¸ªå¤è€çš„å®è—åœ°å›¾ï¼Œå†³å®šå»å¯»æ‰¾ä¼ è¯´ä¸­çš„å®è—',
  imageUrl: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop',
  imageAlt: 'å®è—åœ°å›¾',
  conditions: [
    { type: 'attribute', key: 'intelligence', operator: '>=', value: 5 },
    { type: 'level', key: 'level', operator: '>=', value: 3 }
  ],
  conditionLogic: 'AND',
  outcomes: [
    OutcomeFactory.multipleChoice([
      {
        outcome: OutcomeFactory.randomItemGain('gold', 50, 200),
        weight: 4,
        probability: 0.7
      },
      {
        outcome: OutcomeFactory.randomItemFromList(['rare_gem', 'ancient_artifact', 'magic_scroll'], 1),
        weight: 2,
        probability: 0.4
      },
      {
        outcome: OutcomeFactory.attributeChange('stamina', -3),
        weight: 1,
        probability: 0.3
      }
    ]),
    OutcomeFactory.randomAttributeChange('intelligence', 1, 3)
  ],
  probability: 0.2,
  weight: 8
}
```

### äº‹ä»¶é“¾ç¤ºä¾‹
```typescript
// èµ·å§‹äº‹ä»¶
{
  id: 'merchant_encounter_start',
  type: 'custom',
  name: 'é‡è§ç¥ç§˜å•†äºº',
  description: 'ä½ åœ¨è·¯ä¸Šé‡åˆ°äº†ä¸€ä¸ªç¥ç§˜çš„å•†äººï¼Œä»–ä¼¼ä¹æœ‰è¯è¦è¯´',
  imageUrl: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=300&fit=crop',
  imageAlt: 'ç¥ç§˜å•†äºº',
  isChainStart: true,
  chainId: 'merchant_quest',
  conditions: [
    { type: 'level', key: 'level', operator: '>=', value: 2 }
  ],
  outcomes: [
    OutcomeFactory.attributeChange('intelligence', 1)
  ],
  nextEvents: [
    {
      eventId: 'merchant_task',
      delay: 1,
      conditions: []
    }
  ],
  probability: 0.3,
  weight: 5
},

// åç»­äº‹ä»¶
{
  id: 'merchant_task',
  type: 'custom',
  name: 'å•†äººçš„å§”æ‰˜',
  description: 'å•†äººå§”æ‰˜ä½ å»å¯»æ‰¾ä¸€ä»¶å¤±è½çš„ç‰©å“',
  chainId: 'merchant_quest',
  outcomes: [
    OutcomeFactory.itemGain('quest_item', 1)
  ],
  nextEvents: [
    {
      eventId: 'merchant_reward',
      delay: 2,
      conditions: [
        { type: 'item', key: 'quest_item', operator: '==', value: 1 }
      ]
    }
  ]
},

// ç»“æŸäº‹ä»¶
{
  id: 'merchant_reward',
  type: 'custom',
  name: 'å•†äººçš„å¥–åŠ±',
  description: 'ä½ å®Œæˆäº†å•†äººçš„å§”æ‰˜ï¼Œè·å¾—äº†ä¸°åšçš„å¥–åŠ±',
  chainId: 'merchant_quest',
  isChainEnd: true,
  outcomes: [
    OutcomeFactory.itemLoss('quest_item', 1),
    OutcomeFactory.randomItemGain('gold', 100, 300),
    OutcomeFactory.attributeChange('intelligence', 2)
  ]
}
```

## âœ… æœ€ä½³å®è·µ

### 1. å‘½åè§„èŒƒ
- ä½¿ç”¨æè¿°æ€§çš„IDå’Œåç§°
- ä¿æŒä¸€è‡´çš„å‘½åé£æ ¼
- é¿å…ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦

### 2. å¹³è¡¡æ€§è€ƒè™‘
- åˆç†è®¾ç½®æ¦‚ç‡å’Œæƒé‡
- é¿å…è¿‡äºå¼ºåŠ›çš„å¥–åŠ±
- è€ƒè™‘è´Ÿé¢ç»“æœçš„å¹³è¡¡

### 3. ç”¨æˆ·ä½“éªŒ
- æä¾›æ¸…æ™°çš„äº‹ä»¶æè¿°
- ä½¿ç”¨åˆé€‚çš„å›¾ç‰‡å¢å¼ºæ²‰æµ¸æ„Ÿ
- ç¡®ä¿äº‹ä»¶é€»è¾‘åˆç†

### 4. æŠ€æœ¯å»ºè®®
- ä½¿ç”¨å·¥å‚æ–¹æ³•ç®€åŒ–ä»£ç 
- å……åˆ†åˆ©ç”¨éšæœºåŠŸèƒ½å¢åŠ å˜åŒ–
- åˆç†ä½¿ç”¨äº‹ä»¶é“¾åˆ›å»ºå¤æ‚å‰§æƒ…

### 5. æµ‹è¯•å»ºè®®
- æµ‹è¯•æ‰€æœ‰æ¡ä»¶åˆ†æ”¯
- éªŒè¯éšæœºç»“æœçš„åˆ†å¸ƒ
- ç¡®ä¿äº‹ä»¶é“¾çš„è¿è´¯æ€§

## ğŸš« å¸¸è§é”™è¯¯

### 1. IDé‡å¤
```typescript
// âŒ é”™è¯¯ï¼šIDé‡å¤
{ id: 'forest_event', name: 'æ£®æ—æ¢ç´¢' }
{ id: 'forest_event', name: 'æ£®æ—æˆ˜æ–—' }  // é‡å¤ID

// âœ… æ­£ç¡®ï¼šä½¿ç”¨å”¯ä¸€ID
{ id: 'forest_exploration', name: 'æ£®æ—æ¢ç´¢' }
{ id: 'forest_battle', name: 'æ£®æ—æˆ˜æ–—' }
```

### 2. æ¡ä»¶è®¾ç½®é”™è¯¯
```typescript
// âŒ é”™è¯¯ï¼šæ¡ä»¶è¿‡äºä¸¥è‹›
conditions: [
  { type: 'attribute', key: 'strength', operator: '>=', value: 100 }  // ä¸å¯èƒ½è¾¾åˆ°
]

// âœ… æ­£ç¡®ï¼šåˆç†çš„æ¡ä»¶
conditions: [
  { type: 'attribute', key: 'strength', operator: '>=', value: 5 }
]
```

### 3. ç»“æœä¸å¹³è¡¡
```typescript
// âŒ é”™è¯¯ï¼šå¥–åŠ±è¿‡äºä¸°åš
outcomes: [
  OutcomeFactory.attributeChange('strength', 50)  // è¿‡äºå¼ºåŠ›
]

// âœ… æ­£ç¡®ï¼šå¹³è¡¡çš„å¥–åŠ±
outcomes: [
  OutcomeFactory.randomAttributeChange('strength', 1, 3)
]
```

### 4. å›¾ç‰‡URLé”™è¯¯
```typescript
// âŒ é”™è¯¯ï¼šæ— æ•ˆçš„å›¾ç‰‡URL
imageUrl: 'invalid-url'

// âœ… æ­£ç¡®ï¼šæœ‰æ•ˆçš„å›¾ç‰‡URL
imageUrl: 'https://images.unsplash.com/photo-xxx?w=400&h=300&fit=crop'
```

## ğŸ“š å‚è€ƒèµ„æº

- [äº‹ä»¶ç±»å‹å®šä¹‰](src/eventSystem/eventTypes.ts)
- [ç»“æœå·¥å‚æ–¹æ³•](src/eventSystem/outcomeFactory.ts)
- [éšæœºå¤„ç†å™¨](src/eventSystem/randomProcessor.ts)
- [ç¤ºä¾‹äº‹ä»¶](src/eventSystem/events/randomEvents.ts)

---

é€šè¿‡éµå¾ªæœ¬æŒ‡å—ï¼Œæ‚¨å¯ä»¥åˆ›ä½œå‡ºä¸°å¯Œå¤šå½©ã€å¹³è¡¡æœ‰è¶£çš„æ¸¸æˆäº‹ä»¶ï¼Œä¸ºç©å®¶æä¾›ä¼˜ç§€çš„æ¸¸æˆä½“éªŒï¼